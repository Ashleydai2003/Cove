(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[373],{6649:function(e,t,s){Promise.resolve().then(s.bind(s,1146))},1146:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(7437),l=s(2265),n=s(9376),i=s(7648);class r{async fetchEvent(e){try{let t="".concat(this.baseUrl,"/event?eventId=").concat(encodeURIComponent(e)),s=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"},cache:"force-cache"});if(!s.ok){let e=await s.json().catch(()=>({message:"HTTP ".concat(s.status,": ").concat(s.statusText)}));throw Error(e.message||"Failed to fetch event: ".concat(s.statusText))}return(await s.json()).event}catch(e){if(console.error("Error fetching event:",e),e instanceof Error)throw e;throw Error("Failed to fetch event data")}}async updateRSVP(e,t,s){throw Error("RSVP functionality requires authentication - coming soon!")}constructor(e="https://api.coveapp.co"){this.baseUrl=e}}let c=new r;var o=s(936),d=s(5469),x=s(3774),m=s(2369),h=s(3145),u=s(166);async function f(){try{let e=await fetch("/api/auth/status",{method:"GET",credentials:"include"});if(!e.ok)return{isAuthenticated:!1};{let t=await e.json();return{isAuthenticated:!0,user:t.user}}}catch(e){return console.error("Auth check error:",e),{isAuthenticated:!1}}}var v=s(2489);function b(e){let{isOpen:t,onClose:s,eventId:n}=e,[i,r]=(0,l.useState)([]),[c,o]=(0,l.useState)(!1),[d,x]=(0,l.useState)("");(0,l.useEffect)(()=>{t&&n&&h()},[t,n]);let h=async()=>{o(!0),x("");try{let e=await fetch("/api/event-members?eventId=".concat(n),{credentials:"include"});if(e.ok){let t=await e.json();r(t.members||[])}else{let t=await e.json();x(t.message||"Failed to load guests")}}catch(e){x("Network error. Please try again.")}finally{o(!1)}};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[80vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"guest list"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(v.Z,{size:24})})]}),(0,a.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[c&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading guests..."})]}),d&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-red-600",children:d})}),!c&&!d&&0===i.length&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-600",children:"No guests yet"})}),!c&&!d&&i.length>0&&(0,a.jsx)("div",{className:"space-y-4",children:i.map(e=>{var t;return(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full overflow-hidden bg-gray-200 flex-shrink-0",children:(null===(t=e.profilePhoto)||void 0===t?void 0:t.url)?(0,a.jsx)("img",{src:e.profilePhoto.url,alt:e.name,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full bg-gray-300 flex items-center justify-center",children:(0,a.jsx)(m.Z,{size:20,className:"text-gray-500"})})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"text-gray-900 font-medium",children:e.name})})]},e.id)})})]})]})}):null}let p=(0,u.default)(()=>s.e(421).then(s.bind(s,1421)),{loadableGenerated:{webpack:()=>[1421]},ssr:!1,loading:()=>(0,a.jsx)("div",{children:"Loading..."})});function j(e){var t,s,n;let{event:i}=e,[r,c]=(0,l.useState)(!1),[u,v]=(0,l.useState)(!1),[j,g]=(0,l.useState)(!1),[N,y]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{try{let{isAuthenticated:e}=await f();g(e)}catch(e){console.error("Auth check error:",e),g(!1)}finally{y(!1)}})()},[]);let w=async()=>{j?await C():c(!0)},E="GOING"===i.rsvpStatus||i.isHost,D=j&&i.paymentHandle,C=async()=>{try{let e=await fetch("/api/rsvp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:i.id,status:"PENDING"})});if(e.ok)alert("RSVP successful!");else{let t=await e.json();alert(t.message||"Failed to RSVP")}}catch(e){console.error("RSVP error:",e),alert("Failed to RSVP. Please try again.")}},P=i.name||"Untitled Event",k=(null===(t=i.host)||void 0===t?void 0:t.name)||"",S=function(e){try{let t=(0,o.D)(e);return(0,d.WU)(t,"EEEE, MMMM d")}catch(t){return console.error("Error formatting date:",t),e}}(i.date),B=function(e){try{let t=(0,o.D)(e);return(0,d.WU)(t,"h:mm a")}catch(e){return console.error("Error formatting time:",e),""}}(i.date),F=(null===(s=i.cove)||void 0===s?void 0:s.name)||"",A=k&&F?"hosted by ".concat(k," @ ").concat(F):k?"hosted by ".concat(k):F?"hosted by ".concat(F):"hosted by cove";return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-20 items-start",children:[(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-libre-bodoni text-5xl lg:text-6xl text-[#5E1C1D] leading-[0.9] mb-4",children:P}),(0,a.jsx)("p",{className:"font-libre-bodoni text-base text-[#A8A8A8]",children:A})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-libre-bodoni text-lg text-[#2D2D2D] font-medium",children:S}),(0,a.jsx)("p",{className:"font-libre-bodoni text-base text-[#8B8B8B]",children:B.replace("AM","am").replace("PM","pm")})]}),(0,a.jsx)("div",{className:"h-px w-full bg-[#E5E5E5]"}),null!==i.ticketPrice&&void 0!==i.ticketPrice||null!==i.memberCap&&void 0!==i.memberCap?(0,a.jsxs)("div",{className:"flex items-center gap-8",children:[null!==i.ticketPrice&&void 0!==i.ticketPrice&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-6 bg-[#E8E8E8] rounded-sm"}),(0,a.jsxs)("span",{className:"font-libre-bodoni text-base text-[#2D2D2D]",children:["$",i.ticketPrice.toFixed(2)," per person"]})]}),null!==i.memberCap&&void 0!==i.memberCap&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-6 bg-[#E8E8E8] rounded-sm"}),(0,a.jsx)("span",{className:"font-libre-bodoni text-base text-[#2D2D2D]",children:void 0!==i.goingCount&&null!==i.goingCount?"".concat(Math.max(0,i.memberCap-i.goingCount),"/").concat(i.memberCap," spots left"):"".concat(i.memberCap," spots available")})]})]}):null,i.description&&(0,a.jsx)("div",{className:"space-y-4 max-w-md",children:(0,a.jsx)("div",{className:"font-libre-bodoni text-base text-[#2D2D2D] leading-relaxed whitespace-pre-wrap",children:i.description})}),E&&i.location&&(0,a.jsx)("div",{className:"space-y-4 max-w-md",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{size:16,className:"text-[#8B8B8B]"}),(0,a.jsx)("span",{className:"font-libre-bodoni text-base text-[#2D2D2D]",children:i.location})]})}),j&&!E&&(0,a.jsx)("div",{className:"space-y-4 max-w-md",children:(0,a.jsx)("div",{className:"font-libre-bodoni text-base text-[#8B8B8B]",children:"RSVP to see location and guest list"})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"relative w-full aspect-square rounded-2xl overflow-hidden",children:(null===(n=i.coverPhoto)||void 0===n?void 0:n.url)?(0,a.jsx)(h.default,{src:i.coverPhoto.url,alt:P,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, 50vw",priority:!0}):(0,a.jsx)("div",{className:"w-full h-full bg-gray-200"})}),E&&i.rsvps&&i.rsvps.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-libre-bodoni text-lg text-[#2D2D2D]",children:"guest list"}),(0,a.jsx)("button",{onClick:()=>v(!0),className:"text-[#5E1C1D] underline underline-offset-4 text-sm",children:"view all"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex -space-x-2",children:i.rsvps.slice(0,6).map((e,t)=>(0,a.jsx)("div",{className:"w-12 h-12 rounded-full overflow-hidden border-2 border-white bg-gray-200",children:e.profilePhotoUrl?(0,a.jsx)("img",{src:e.profilePhotoUrl,alt:e.userName,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full bg-gray-300 flex items-center justify-center",children:(0,a.jsx)(m.Z,{size:16,className:"text-gray-500"})})},e.id))}),i.goingCount&&i.goingCount>6&&(0,a.jsxs)("span",{className:"font-libre-bodoni text-sm text-[#8B8B8B]",children:["+",i.goingCount-6," others going"]})]})]}),D&&(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"font-libre-bodoni text-sm text-[#2D2D2D]",children:["venmo @",i.paymentHandle]})}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("button",{onClick:w,className:"px-16 py-3 bg-[#F5F5F5] text-[#2D2D2D] rounded-full font-libre-bodoni text-lg border border-[#E5E5E5] hover:bg-[#EEEEEE] transition-colors",children:"rsvp"})})]})]}),(0,a.jsx)(p,{isOpen:r,onClose:()=>c(!1),onComplete:e=>{g(!0),c(!1),C()},originalAction:"RSVP to this event"}),(0,a.jsx)(b,{isOpen:u,onClose:()=>v(!1),eventId:i.id})]})}function g(){let e=(0,n.useParams)(),t=null==e?void 0:e.eventId,[s,r]=(0,l.useState)(null),[o,d]=(0,l.useState)(!0),[x,m]=(0,l.useState)(null);return((0,l.useEffect)(()=>{t&&(async()=>{try{d(!0),m(null),console.log("Fetching event with ID:",t),console.log("API URL:","https://api.coveapp.co");let e=await c.fetchEvent(t);console.log("Event data received:",e),r(e)}catch(e){console.error("Error fetching event:",e),m(e instanceof Error?e.message:"Failed to load event")}finally{d(!1)}})()},[t]),o)?(0,a.jsx)("div",{className:"min-h-screen bg-[#F5F0E6] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#5E1C1D] mx-auto mb-4"}),(0,a.jsx)("p",{className:"font-libre-bodoni text-[#5E1C1D]",children:"Loading event..."}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Event ID: ",t]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["API URL: ","https://api.coveapp.co"]})]})}):x?(0,a.jsx)("div",{className:"min-h-screen bg-[#F5F0E6] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,a.jsx)("h2",{className:"font-libre-bodoni text-2xl font-semibold text-[#5E1C1D] mb-4",children:x.includes("not found")?"Event not found":"Something went wrong"}),(0,a.jsx)("p",{className:"font-libre-bodoni text-lg text-[#8B8B8B] mb-6",children:x}),(0,a.jsx)(i.default,{href:"/",className:"font-libre-bodoni text-[#5E1C1D] underline underline-offset-4",children:"Back to home"})]})}):s?(0,a.jsxs)("div",{className:"min-h-screen bg-[#F5F0E6]",children:[(0,a.jsx)("div",{className:"w-full px-8 pt-8 pb-12",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-libre-bodoni text-3xl text-[#5E1C1D]",children:"cove"}),(0,a.jsx)(i.default,{href:"/",className:"font-libre-bodoni text-[#5E1C1D] underline underline-offset-4 text-lg",children:"join the waitlist"})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-8 pb-16",children:(0,a.jsx)(j,{event:s})})]}):(0,a.jsx)("div",{className:"min-h-screen bg-[#F5F0E6] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,a.jsx)("h2",{className:"font-libre-bodoni text-2xl font-semibold text-[#5E1C1D] mb-4",children:"Event not found"}),(0,a.jsx)("p",{className:"font-libre-bodoni text-lg text-[#8B8B8B] mb-6",children:"This event may have been deleted or the link is incorrect."}),(0,a.jsx)(i.default,{href:"/",className:"font-libre-bodoni text-[#5E1C1D] underline underline-offset-4",children:"Back to home"})]})})}}},function(e){e.O(0,[671,971,117,744],function(){return e(e.s=6649)}),_N_E=e.O()}]);